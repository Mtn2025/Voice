{% for call in history %}
<tr class="bg-slate-800 border-b border-slate-700 hover:bg-slate-700 transition">
    <td class="px-4 py-2 w-4">
        <input type="checkbox" value="{{ call.id }}"
            class="history-checkbox rounded border-slate-600 bg-slate-800 text-blue-600 focus:ring-offset-slate-800"
            onclick="updateDeleteButton()">
    </td>
    <td class="px-4 py-2 text-white font-medium">{{ call.id }}</td>
    <td class="px-4 py-2">{{ call.start_time.strftime('%Y-%m-%d %H:%M') }}</td>
    <td class="px-4 py-2">
        <span
            class="px-2 py-1 rounded text-xs {{ 'bg-green-900 text-green-300' if call.status == 'completed' else 'bg-yellow-900 text-yellow-300' }}">
            {{ 'Completada' if call.status == 'completed' else 'En Curso' if call.status == 'in-progress' else
            call.status }}
        </span>
    </td>
    <td class="px-4 py-2 text-right">
        <div class="flex justify-end space-x-2">
            <a href="/dashboard/call/{{ call.id }}"
                class="inline-flex items-center space-x-1 text-blue-400 hover:text-blue-300 font-medium">
                <span>Revisar</span>
                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                        d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14">
                    </path>
                </svg>
            </a>
        </div>
    </td>
</tr>
{% else %}
<tr>
    <td colspan="5" class="px-4 py-8 text-center text-slate-500 italic">No se han registrado llamadas recientes.</td>
</tr>
{% endfor %}

<!-- OOB Swap for Pagination Footer -->
<div id="history-pagination" hx-swap-oob="true" class="flex justify-between items-center pt-2 w-full">
    <span class="text-xs text-slate-500 p-2">
        PÃ¡gina <span class="text-white">{{ page }}</span> de <span class="text-white">{{ total_pages }}</span>
        (Total: {{ total_items }})
    </span>
    <div class="space-x-2">
        {% if page > 1 %}
        <button hx-get="/dashboard/history-rows?page={{ page - 1 }}" hx-include="[name='limit']"
            hx-target="#history-body"
            class="px-3 py-1 bg-slate-700 hover:bg-slate-600 rounded text-xs text-white transition">
            &larr; Anterior
        </button>
        {% endif %}

        {% if page < total_pages %} <button hx-get="/dashboard/history-rows?page={{ page + 1 }}"
            hx-include="[name='limit']" hx-target="#history-body"
            class="px-3 py-1 bg-slate-700 hover:bg-slate-600 rounded text-xs text-white transition">
            Siguiente &rarr;
            </button>
            {% endif %}
    </div>
</div>

<!-- OOB Swap for Badge -->
<span id="total-items-badge" hx-swap-oob="true" class="font-mono text-slate-300">{{ total_items }}</span>