<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Panel de Control - Asistente IA</title>
    <!-- AlpineJS loaded via main.js module -->
    <link rel="icon" href="https://fav.farm/ü§ñ" />
    <!-- Tailwind CSS (CDN Backup restored per user request for visual fidelity) -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        slate: {
                            850: '#151e32',
                            900: '#0f172a',
                            950: '#020617',
                        }
                    }
                }
            }
        }
    </script>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700&display=swap"
        rel="stylesheet">
    <style>
        body {
            font-family: 'Plus Jakarta Sans', sans-serif;
            background-color: #020617;
            /* Slate 950 */
            color: #ffffff;
        }


        .glass-panel {
            background: rgba(255, 255, 255, 0.03);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
        }

        .glass-input {
            background: rgba(15, 23, 42, 0.6);
            border: 1px solid rgba(255, 255, 255, 0.1);
            color: white;
            transition: all 0.2s;
        }

        .glass-input:focus {
            border-color: #3b82f6;
            background: rgba(15, 23, 42, 0.95);
            outline: none;
        }

        /* Custom Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }

        ::-webkit-scrollbar-track {
            background: #1e293b;
        }

        ::-webkit-scrollbar-thumb {
            background: #475569;
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: #64748b;
        }

        @keyframes pulse-ring {
            0% {
                transform: scale(0.8);
                opacity: 0.5;
            }

            100% {
                transform: scale(2);
                opacity: 0;
            }
        }

        .animate-pulse-ring::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            right: 0;
            bottom: 0;
            border-radius: 50%;
            border: 2px solid #34d399;
            animation: pulse-ring 2s infinite;
        }

        svg {
            max-width: 24px;
            max-height: 24px;
        }
    </style>
</head>

<body class="overflow-hidden h-screen flex bg-[#020617]" x-data="dashboard()">
    <!-- Icons Injection -->
    {% include 'partials/icons.html' %}

    <!-- Data Injection -->
    <script id="server-config" type="application/json">
        {{ config_json | safe }}
    </script>
    <script id="server-voices" type="application/json">
        {{ voices_json | safe }}
    </script>
    <script id="server-styles" type="application/json">
        {{ styles_json | safe }}
    </script>
    <script id="server-models" type="application/json">
        {{ models_json | safe }}
    </script>
    <script id="server-langs" type="application/json">
        {{ langs_json | safe }}
    </script>

    <!-- CORE FRAMEWORK -->
    <div class="flex h-screen overflow-hidden">

        <!-- SIDEBAR NAVIGATION (THE RAIL) -->
        <nav class="w-16 flex-none bg-[#0B1121] border-r border-[#1E293B] flex flex-col items-center py-4 z-30">
            <!-- Brand Logo -->
            <div
                class="mb-6 w-10 h-10 rounded-xl bg-gradient-to-tr from-blue-600 to-indigo-600 flex items-center justify-center text-white font-bold shadow-lg shadow-blue-500/20">
                <span class="text-sm">IA</span>
            </div>

            <!-- Nav Items -->
            <div class="flex-1 w-full px-2 space-y-2 flex flex-col items-center">
                <template x-for="tab in [
                    {id:'model', icon:'cpu', label:'Modelo'}, 
                    {id:'voz', icon:'mic', label:'Voz'}, 
                    {id:'transcriptor', icon:'ear', label:'O√≠do'}, 
                    {id:'tools', icon:'briefcase', label:'Herramientas'},
                    {id:'campaigns', icon:'megaphone', label:'Campa√±as'}, 
                    {id:'connectivity', icon:'zap', label:'Conectividad'},
                    {id:'system', icon:'shield', label:'Sistema'},
                    {id:'avanzado', icon:'settings', label:'Avanzado'}, 
                    {id:'historial', icon:'history', label:'Historial'}
                ]">
                    <div class="group relative flex items-center justify-center">
                        <button @click="activeTab = tab.id" x-show="shouldShowTab(tab.label)"
                            :class="{'bg-blue-600 text-white shadow-lg shadow-blue-900/20': activeTab === tab.id, 'text-slate-500 hover:text-slate-300 hover:bg-slate-800/50': activeTab !== tab.id}"
                            class="w-10 h-10 rounded-xl flex items-center justify-center transition-all duration-200 relative group-hover:scale-105">
                            <svg class="w-5 h-5 pointer-events-none" style="width: 20px; height: 20px;">
                                <use :href="'#icon-' + tab.icon"></use>
                            </svg>
                        </button>
                        <!-- Tooltip -->
                        <div
                            class="absolute left-14 bg-slate-800 text-white text-xs px-2 py-1 rounded opacity-0 group-hover:opacity-100 transition-opacity pointer-events-none whitespace-nowrap z-50 border border-slate-700 font-medium">
                            <span x-text="tab.label"></span>
                        </div>
                    </div>
                </template>
            </div>

            <!-- Bottom Actions -->
            <div class="mt-auto px-2 space-y-2">
                <!-- User/Footer Icon could go here -->
            </div>
        </nav>

        <!-- CONFIGURATION PANEL (Resizable) -->
        <aside x-data="{ 
                sidebarWidth: localStorage.getItem('sidebarWidth') || 480,
                resizing: false,
                startResize(e) {
                    this.resizing = true;
                    document.body.style.cursor = 'col-resize';
                    document.body.style.userSelect = 'none';
                },
                doResize(e) {
                    if (!this.resizing) return;
                    // 64px is the Nav Rail width
                    let newWidth = e.clientX - 64; 
                    // Constraints
                    if (newWidth < 320) newWidth = 320;
                    if (newWidth > 800) newWidth = 800;
                    this.sidebarWidth = newWidth;
                },
                stopResize() {
                    if (this.resizing) {
                        this.resizing = false;
                        localStorage.setItem('sidebarWidth', this.sidebarWidth);
                        document.body.style.cursor = '';
                        document.body.style.userSelect = '';
                    }
                }
            }" @mousemove.window="doResize($event)" @mouseup.window="stopResize()" :style="`width: ${sidebarWidth}px`"
            class="flex-none flex flex-col bg-[#0F172A]/90 backdrop-blur-md border-r border-[#1E293B] z-20 relative shadow-2xl shrink-0">

            <!-- RESIZE HANDLE -->
            <div class="absolute top-0 right-0 w-1.5 h-full cursor-col-resize hover:bg-blue-500/50 z-[100] transition-colors"
                @mousedown="startResize">
            </div>

            <!-- HEADER: Profile Selector -->
            <div
                class="h-16 flex items-center justify-between px-6 border-b border-[#1E293B] bg-[#0F172A]/50 backdrop-blur shrink-0">
                <h2 class="text-sm font-bold text-slate-100 tracking-wide uppercase">Configuraci√≥n</h2>

                <!-- Profile Switcher Pill -->
                <div class="flex bg-[#1E293B] rounded-lg p-1 border border-slate-700/50">
                    <template x-for="p in [
                        {id:'browser', icon:'browser', label: 'Simulador Web'}, 
                        {id:'twilio', icon:'smartphone', label: 'Telefon√≠a Twilio'}, 
                        {id:'telnyx', icon:'radio', label: 'Telefon√≠a Telnyx'}
                     ]">
                        <div class="relative group">
                            <button @click="activeProfile = p.id"
                                :class="{'bg-[#334155] text-white shadow-sm ring-1 ring-white/10': activeProfile === p.id, 'text-slate-400 hover:text-slate-200': activeProfile !== p.id}"
                                class="w-8 h-8 rounded-md flex items-center justify-center transition-all relative">
                                <svg class="w-4 h-4" style="width: 16px; height: 16px;">
                                    <use :href="'#icon-' + p.icon"></use>
                                </svg>
                            </button>
                            <!-- Tooltip -->
                            <div
                                class="absolute top-full right-0 mt-2 w-max bg-slate-800 text-white text-[10px] px-2 py-1 rounded opacity-0 group-hover:opacity-100 transition-opacity pointer-events-none border border-slate-700 z-50 shadow-lg font-medium">
                                <span x-text="p.label"></span>
                            </div>
                        </div>
                    </template>
                </div>
            </div>

            <div class="p-0 h-full flex flex-col relative overflow-hidden">
                <form id="configForm" @submit.prevent="saveConfig()" class="h-full flex flex-col relative">

                    <!-- SCROLLABLE CONFIG AREA -->
                    <div class="flex-1 overflow-y-auto p-4 space-y-6 pb-24 custom-scrollbar" id="config-scroll-area">
                        <!-- Dynamic Title -->
                        <div class="flex items-center space-x-2 text-blue-400 mb-2">
                            <svg class="w-5 h-5">
                                <use
                                    :href="'#icon-' + (activeTab === 'voz' ? 'mic' : (activeTab === 'model' ? 'cpu' : 'settings'))">
                                </use>
                            </svg>
                            <h3 class="text-lg font-bold text-white tracking-tight first-letter:uppercase"
                                x-text="activeTab"></h3>
                        </div>


                        {% include 'partials/tab_model.html' %}
                        {% include 'partials/tab_voice.html' %}
                        {% include 'partials/tab_transcriber.html' %}
                        {% include 'partials/tab_flow.html' %}
                        {% include 'partials/tab_tools.html' %}
                        {% include 'partials/tab_analysis.html' %}
                        {% include 'partials/tab_system.html' %}
                        {% include 'partials/tab_campaigns.html' %}
                        {% include 'partials/tab_advanced.html' %}
                        {% include 'partials/tab_history.html' %}
                        {% include 'partials/tab_connectivity.html' %}

                        <!-- HIDDEN INPUTS PRESERVED HERE -->
                        <!-- Browser Profile (Default) -->
                        <input type="hidden" name="llm_provider" :value="configs.browser.provider">
                        <input type="hidden" name="llm_model" :value="configs.browser.model">
                        <input type="hidden" name="temperature" :value="configs.browser.temp">
                        <input type="hidden" name="max_tokens" :value="configs.browser.tokens">
                        <input type="hidden" name="first_message" :value="configs.browser.msg">
                        <input type="hidden" name="first_message_mode" :value="configs.browser.mode">
                        <input type="hidden" name="system_prompt" :value="configs.browser.prompt">

                        <input type="hidden" name="tts_provider" :value="configs.browser.voiceProvider">
                        <input type="hidden" name="voice_name" :value="configs.browser.voiceId">
                        <input type="hidden" name="voice_style" :value="configs.browser.voiceStyle">
                        <input type="hidden" name="voice_speed" :value="configs.browser.voiceSpeed">
                        <input type="hidden" name="voice_pitch" :value="configs.browser.voicePitch">
                        <input type="hidden" name="voice_volume" :value="configs.browser.voiceVolume">
                        <input type="hidden" name="voice_style_degree" :value="configs.browser.voiceStyleDegree">
                        <input type="hidden" name="voice_pacing_ms" :value="configs.browser.voicePacing">
                        <input type="hidden" name="background_sound" :value="configs.browser.voiceBgSound">
                        <input type="hidden" name="background_sound_url" :value="configs.browser.voiceBgUrl">

                        <input type="hidden" name="stt_provider" :value="configs.browser.sttProvider">
                        <input type="hidden" name="stt_language" :value="configs.browser.sttLang">
                        <input type="hidden" name="interruption_threshold" :value="configs.browser.interruptWords">
                        <input type="hidden" name="silence_timeout_ms" :value="configs.browser.silence">
                        <input type="hidden" name="segmentation_strategy" :value="configs.browser.segmentationStrategy">
                        <input type="hidden" name="hallucination_blacklist" :value="configs.browser.blacklist">

                        <input type="hidden" name="enable_end_call" :value="configs.browser.enableEndCall">
                        <input type="hidden" name="enable_dial_keypad" :value="configs.browser.dialKeypad">
                        <input type="hidden" name="transfer_phone_number" :value="configs.browser.transferNum">

                        <input type="hidden" name="idle_timeout" :value="configs.browser.idleTimeout">
                        <input type="hidden" name="max_duration" :value="configs.browser.maxDuration">
                        <input type="hidden" name="idle_message" :value="configs.browser.idleMessage">
                        <input type="hidden" name="inactivity_max_retries" :value="configs.browser.maxRetries">
                        <input type="hidden" name="enable_denoising" :value="configs.browser.denoise">
                        <input type="hidden" name="extraction_model" :value="configs.browser.extractionModel">

                        <input type="hidden" name="response_length" :value="configs.browser.responseLength">
                        <input type="hidden" name="conversation_tone" :value="configs.browser.conversationTone">
                        <input type="hidden" name="conversation_formality"
                            :value="configs.browser.conversationFormality">
                        <input type="hidden" name="conversation_pacing" :value="configs.browser.conversationPacing">

                        <!-- NEW: Advanced LLM Controls (Browser) -->
                        <input type="hidden" name="context_window" :value="configs.browser.contextWindow">
                        <input type="hidden" name="frequency_penalty" :value="configs.browser.frequencyPenalty">
                        <input type="hidden" name="presence_penalty" :value="configs.browser.presencePenalty">
                        <input type="hidden" name="tool_choice" :value="configs.browser.toolChoice">
                        <input type="hidden" name="dynamic_vars_enabled" :value="configs.browser.dynamicVarsEnabled">
                        <input type="hidden" name="dynamic_vars" :value="configs.browser.dynamicVars">

                        <input type="hidden" name="llm_provider_phone" :value="configs.twilio.provider">
                        <input type="hidden" name="llm_model_phone" :value="configs.twilio.model">
                        <input type="hidden" name="temperature_phone" :value="configs.twilio.temp">
                        <input type="hidden" name="max_tokens_phone" :value="configs.twilio.tokens">
                        <input type="hidden" name="system_prompt_phone" :value="configs.twilio.prompt">
                        <input type="hidden" name="first_message_phone" :value="configs.twilio.msg">
                        <input type="hidden" name="first_message_mode_phone" :value="configs.twilio.mode">

                        <!-- NEW: TTS Controls (Browser) -->
                        <input type="hidden" name="voice_stability" :value="configs.browser.voiceStability">
                        <input type="hidden" name="voice_similarity_boost"
                            :value="configs.browser.voiceSimilarityBoost">
                        <input type="hidden" name="voice_style_exaggeration"
                            :value="configs.browser.voiceStyleExaggeration">
                        <input type="hidden" name="voice_speaker_boost" :value="configs.browser.voiceSpeakerBoost">
                        <input type="hidden" name="voice_multilingual" :value="configs.browser.voiceMultilingual">
                        <input type="hidden" name="tts_latency_optimization"
                            :value="configs.browser.ttsLatencyOptimization">
                        <input type="hidden" name="tts_output_format" :value="configs.browser.ttsOutputFormat">
                        <input type="hidden" name="voice_filler_injection"
                            :value="configs.browser.voiceFillerInjection">
                        <input type="hidden" name="voice_backchanneling" :value="configs.browser.voiceBackchanneling">
                        <input type="hidden" name="text_normalization_rule"
                            :value="configs.browser.textNormalizationRule">

                        <input type="hidden" name="tts_provider_phone" :value="configs.twilio.voiceProvider">
                        <input type="hidden" name="voice_name_phone" :value="configs.twilio.voiceId">
                        <input type="hidden" name="voice_style_phone" :value="configs.twilio.voiceStyle">
                        <input type="hidden" name="voice_speed_phone" :value="configs.twilio.voiceSpeed">
                        <input type="hidden" name="voice_pitch_phone" :value="configs.twilio.voicePitch">
                        <input type="hidden" name="voice_volume_phone" :value="configs.twilio.voiceVolume">
                        <input type="hidden" name="voice_style_degree_phone" :value="configs.twilio.voiceStyleDegree">
                        <input type="hidden" name="voice_pacing_ms_phone" :value="configs.twilio.voicePacing">
                        <input type="hidden" name="background_sound_phone" :value="configs.twilio.voiceBgSound">

                        <!-- NEW: TTS Controls (Twilio) -->
                        <input type="hidden" name="voice_stability_phone" :value="configs.twilio.voiceStability">
                        <input type="hidden" name="voice_similarity_boost_phone"
                            :value="configs.twilio.voiceSimilarityBoost">
                        <input type="hidden" name="voice_style_exaggeration_phone"
                            :value="configs.twilio.voiceStyleExaggeration">
                        <input type="hidden" name="voice_speaker_boost_phone" :value="configs.twilio.voiceSpeakerBoost">
                        <input type="hidden" name="voice_multilingual_phone" :value="configs.twilio.voiceMultilingual">
                        <input type="hidden" name="tts_latency_optimization_phone"
                            :value="configs.twilio.ttsLatencyOptimization">
                        <input type="hidden" name="tts_output_format_phone" :value="configs.twilio.ttsOutputFormat">
                        <input type="hidden" name="voice_filler_injection_phone"
                            :value="configs.twilio.voiceFillerInjection">
                        <input type="hidden" name="voice_backchanneling_phone"
                            :value="configs.twilio.voiceBackchanneling">
                        <input type="hidden" name="text_normalization_rule_phone"
                            :value="configs.twilio.textNormalizationRule">

                        <input type="hidden" name="stt_provider_phone" :value="configs.twilio.sttProvider">
                        <input type="hidden" name="stt_language_phone" :value="configs.twilio.sttLang">
                        <input type="hidden" name="interruption_threshold_phone" :value="configs.twilio.interruptWords">
                        <input type="hidden" name="silence_timeout_ms_phone" :value="configs.twilio.silence">
                        <input type="hidden" name="input_min_characters_phone" :value="configs.twilio.inputMin">
                        <input type="hidden" name="hallucination_blacklist_phone" :value="configs.twilio.blacklist">
                        <input type="hidden" name="enable_denoising_phone" :value="configs.twilio.denoise">

                        <input type="hidden" name="response_length_phone" :value="configs.twilio.responseLength">
                        <input type="hidden" name="conversation_tone_phone" :value="configs.twilio.conversationTone">
                        <input type="hidden" name="conversation_formality_phone"
                            :value="configs.twilio.conversationFormality">
                        <input type="hidden" name="conversation_pacing_phone"
                            :value="configs.twilio.conversationPacing">

                        <!-- NEW: Advanced LLM Controls (Twilio) -->
                        <input type="hidden" name="context_window_phone" :value="configs.twilio.contextWindow">
                        <input type="hidden" name="frequency_penalty_phone" :value="configs.twilio.frequencyPenalty">
                        <input type="hidden" name="presence_penalty_phone" :value="configs.twilio.presencePenalty">
                        <input type="hidden" name="tool_choice_phone" :value="configs.twilio.toolChoice">
                        <input type="hidden" name="dynamic_vars_enabled_phone"
                            :value="configs.twilio.dynamicVarsEnabled">
                        <input type="hidden" name="dynamic_vars_phone" :value="configs.twilio.dynamicVars">

                        <input type="hidden" name="llm_provider_telnyx" :value="configs.telnyx.provider">
                        <input type="hidden" name="llm_model_telnyx" :value="configs.telnyx.model">
                        <input type="hidden" name="temperature_telnyx" :value="configs.telnyx.temp">
                        <input type="hidden" name="max_tokens_telnyx" :value="configs.telnyx.tokens">
                        <input type="hidden" name="system_prompt_telnyx" :value="configs.telnyx.prompt">
                        <input type="hidden" name="first_message_telnyx" :value="configs.telnyx.msg">
                        <input type="hidden" name="first_message_mode_telnyx" :value="configs.telnyx.mode">

                        <input type="hidden" name="tts_provider_telnyx" :value="configs.telnyx.voiceProvider">
                        <input type="hidden" name="voice_name_telnyx" :value="configs.telnyx.voiceId">
                        <input type="hidden" name="voice_style_telnyx" :value="configs.telnyx.voiceStyle">
                        <input type="hidden" name="voice_speed_telnyx" :value="configs.telnyx.voiceSpeed">
                        <input type="hidden" name="voice_pitch_telnyx" :value="configs.telnyx.voicePitch">
                        <input type="hidden" name="voice_volume_telnyx" :value="configs.telnyx.voiceVolume">
                        <input type="hidden" name="voice_style_degree_telnyx" :value="configs.telnyx.voiceStyleDegree">
                        <input type="hidden" name="voice_pacing_ms_telnyx" :value="configs.telnyx.voicePacing">
                        <input type="hidden" name="background_sound_telnyx" :value="configs.telnyx.voiceBgSound">
                        <input type="hidden" name="background_sound_url_telnyx" :value="configs.telnyx.voiceBgUrl">

                        <!-- NEW: TTS Controls (Telnyx) -->
                        <input type="hidden" name="voice_stability_telnyx" :value="configs.telnyx.voiceStability">
                        <input type="hidden" name="voice_similarity_boost_telnyx"
                            :value="configs.telnyx.voiceSimilarityBoost">
                        <input type="hidden" name="voice_style_exaggeration_telnyx"
                            :value="configs.telnyx.voiceStyleExaggeration">
                        <input type="hidden" name="voice_speaker_boost_telnyx"
                            :value="configs.telnyx.voiceSpeakerBoost">
                        <input type="hidden" name="voice_multilingual_telnyx" :value="configs.telnyx.voiceMultilingual">
                        <input type="hidden" name="tts_latency_optimization_telnyx"
                            :value="configs.telnyx.ttsLatencyOptimization">
                        <input type="hidden" name="tts_output_format_telnyx" :value="configs.telnyx.ttsOutputFormat">
                        <input type="hidden" name="voice_filler_injection_telnyx"
                            :value="configs.telnyx.voiceFillerInjection">
                        <input type="hidden" name="voice_backchanneling_telnyx"
                            :value="configs.telnyx.voiceBackchanneling">
                        <input type="hidden" name="text_normalization_rule_telnyx"
                            :value="configs.telnyx.textNormalizationRule">

                        <input type="hidden" name="stt_provider_telnyx" :value="configs.telnyx.sttProvider">
                        <input type="hidden" name="stt_language_telnyx" :value="configs.telnyx.sttLang">
                        <input type="hidden" name="interruption_threshold_telnyx"
                            :value="configs.telnyx.interruptWords">
                        <input type="hidden" name="voice_sensitivity_telnyx" :value="configs.telnyx.interruptRMS">
                        <input type="hidden" name="silence_timeout_ms_telnyx" :value="configs.telnyx.silence">
                        <input type="hidden" name="input_min_characters_telnyx" :value="configs.telnyx.inputMin">
                        <input type="hidden" name="hallucination_blacklist_telnyx" :value="configs.telnyx.blacklist">
                        <input type="hidden" name="enable_denoising_telnyx" :value="configs.telnyx.denoise">
                        <input type="hidden" name="enable_krisp_telnyx" :value="configs.telnyx.krisp">
                        <input type="hidden" name="enable_vad_telnyx" :value="configs.telnyx.vad">

                        <input type="hidden" name="idle_timeout_telnyx" :value="configs.telnyx.idleTimeout">
                        <input type="hidden" name="max_duration_telnyx" :value="configs.telnyx.maxDuration">
                        <input type="hidden" name="idle_message_telnyx" :value="configs.telnyx.idleMessage">
                        <input type="hidden" name="enable_recording_telnyx" :value="configs.telnyx.enableRecording">
                        <input type="hidden" name="amd_config_telnyx" :value="configs.telnyx.amdConfig">

                        <input type="hidden" name="response_length_telnyx" :value="configs.telnyx.responseLength">
                        <input type="hidden" name="conversation_tone_telnyx" :value="configs.telnyx.conversationTone">
                        <input type="hidden" name="conversation_formality_telnyx"
                            :value="configs.telnyx.conversationFormality">
                        <input type="hidden" name="conversation_pacing_telnyx"
                            :value="configs.telnyx.conversationPacing">

                        <!-- NEW: Advanced LLM Controls (Telnyx) -->
                        <input type="hidden" name="context_window_telnyx" :value="configs.telnyx.contextWindow">
                        <input type="hidden" name="frequency_penalty_telnyx" :value="configs.telnyx.frequencyPenalty">
                        <input type="hidden" name="presence_penalty_telnyx" :value="configs.telnyx.presencePenalty">
                        <input type="hidden" name="tool_choice_telnyx" :value="configs.telnyx.toolChoice">
                        <input type="hidden" name="dynamic_vars_enabled_telnyx"
                            :value="configs.telnyx.dynamicVarsEnabled">
                        <input type="hidden" name="dynamic_vars_telnyx" :value="configs.telnyx.dynamicVars">

                        <input type="hidden" name="crm_enabled" :value="configs.browser.crm_enabled">
                        <input type="hidden" name="baserow_token" :value="configs.browser.baserow_token">
                        <input type="hidden" name="baserow_table_id" :value="configs.browser.baserow_table_id">
                        <input type="hidden" name="webhook_url" :value="configs.browser.webhook_url">
                        <input type="hidden" name="webhook_secret" :value="configs.browser.webhook_secret">

                        <!-- Rate Limits -->
                        <input type="hidden" name="rate_limit_global" :value="configs.browser.rateLimitGlobal">
                        <input type="hidden" name="rate_limit_twilio" :value="configs.browser.rateLimitTwilio">
                        <input type="hidden" name="rate_limit_telnyx" :value="configs.browser.rateLimitTelnyx">

                        <!-- NEW: Connectivity & System Inputs (Wired for 100% Connectivity) -->
                        <input type="hidden" name="twilioAccountSid" :value="configs.browser.twilioAccountSid">
                        <input type="hidden" name="twilioAuthToken" :value="configs.browser.twilioAuthToken">
                        <input type="hidden" name="twilioFromNumber" :value="configs.browser.twilioFromNumber">

                        <input type="hidden" name="telnyxApiKey" :value="configs.browser.telnyxApiKey">
                        <input type="hidden" name="telnyxConnectionId" :value="configs.browser.telnyxConnectionId">
                        <input type="hidden" name="callerIdTelnyx" :value="configs.browser.callerIdTelnyx">

                        <input type="hidden" name="sipTrunkUriPhone" :value="configs.browser.sipTrunkUriPhone">
                        <input type="hidden" name="sipAuthUserPhone" :value="configs.browser.sipAuthUserPhone">
                        <input type="hidden" name="sipAuthPassPhone" :value="configs.browser.sipAuthPassPhone">
                        <input type="hidden" name="fallbackNumberPhone" :value="configs.browser.fallbackNumberPhone">
                        <input type="hidden" name="geoRegionPhone" :value="configs.browser.geoRegionPhone">

                        <input type="hidden" name="sipTrunkUriTelnyx" :value="configs.browser.sipTrunkUriTelnyx">
                        <input type="hidden" name="sipAuthUserTelnyx" :value="configs.browser.sipAuthUserTelnyx">
                        <input type="hidden" name="sipAuthPassTelnyx" :value="configs.browser.sipAuthPassTelnyx">
                        <input type="hidden" name="fallbackNumberTelnyx" :value="configs.browser.fallbackNumberTelnyx">
                        <input type="hidden" name="geoRegionTelnyx" :value="configs.browser.geoRegionTelnyx">

                        <input type="hidden" name="recordingChannelsPhone"
                            :value="configs.browser.recordingChannelsPhone">
                        <input type="hidden" name="recordingChannelsTelnyx"
                            :value="configs.browser.recordingChannelsTelnyx">
                        <input type="hidden" name="hipaaEnabledPhone" :value="configs.browser.hipaaEnabledPhone">
                        <input type="hidden" name="hipaaEnabledTelnyx" :value="configs.browser.hipaaEnabledTelnyx">
                        <input type="hidden" name="dtmfListeningEnabledPhone"
                            :value="configs.browser.dtmfListeningEnabledPhone">

                        <input type="hidden" name="concurrencyLimit" :value="configs.browser.concurrencyLimit">
                        <input type="hidden" name="spendLimitDaily" :value="configs.browser.spendLimitDaily">
                        <input type="hidden" name="environment" :value="configs.browser.environment">
                        <input type="hidden" name="privacyMode" :value="configs.browser.privacyMode">
                        <input type="hidden" name="auditLogEnabled" :value="configs.browser.auditLogEnabled">
                    </div>

            </div>

            <!-- FOOTER ACTIONS -->
            <!-- FOOTER ACTIONS (Sticky Bottom) -->
            <div x-show="activeTab !== 'historial'"
                class="p-4 border-t border-[#1E293B] bg-[#0F172A] sticky bottom-0 z-50">
                <button type="button" @click.prevent="saveConfig()"
                    class="bg-blue-600 hover:bg-blue-500 text-white px-6 py-2.5 rounded-lg text-sm font-semibold shadow-lg shadow-blue-500/20 transition-all flex items-center space-x-2 w-full justify-center group">
                    <svg class="w-4 h-4 text-blue-200 group-hover:text-white transition-colors">
                        <use href="#icon-save"></use>
                    </svg>
                    <span>Guardar Configuraci√≥n</span>
                </button>
            </div>
            </form>
    </div>
    </aside>

    <!-- MAIN AREA: SIMULATOR -->
    <main class="flex-1 bg-[#020617] relative flex flex-col overflow-hidden">
        <!-- Top bar for Sim? -->
        <div class="h-16 flex items-center justify-between px-8 border-b border-[#1E293B] shrink-0">
            <h1 class="font-bold text-lg text-slate-100">Simulador de Conversaci√≥n</h1>
            <div class="flex items-center space-x-4 text-xs text-slate-500">
                <span class="flex items-center"><span class="w-2 h-2 rounded-full bg-green-500 mr-2"></span> Sistema en
                    l√≠nea</span>
            </div>
        </div>

        <div class="flex-1 overflow-hidden relative p-8 flex flex-col items-center justify-center">
            <div class="w-full max-w-4xl h-full flex flex-col transition-all duration-300 mx-auto"
                :class="showDebug ? 'mr-4' : 'mr-auto'">
                {% include 'partials/panel_simulator.html' %}
            </div>

            <!-- Empty State Decoration -->
            <div class="absolute inset-0 pointer-events-none flex items-center justify-center opacity-[0.02]">
                <svg class="w-96 h-96">
                    <use href="#icon-cpu"></use>
                </svg>
            </div>
        </div>
    </main>
    </div>

    <!-- JAVASCRIPT MODULES -->
    <script type="module" src="{{ url_for('static', path='js/main.js') }}?v={{ range(1000, 9999) | random }}"></script>
</body>

</html>